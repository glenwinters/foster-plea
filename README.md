# Foster Plea

A Google Apps Script to build draft plea emails from a spreadsheet.

## Usage

This is still in development, so the steps are a bit manual and some values need
to change for the final spreadsheet.

Right now, a test spreadsheet has to have the following columns, in order:
* Type of Animal
* Status
* Name
* Age
* Physical Description
* Plea Notes
* Photo
* Feeding Notes

Push the code. You can't copy and paste because the code in this repo is in
TypeScript and running `clasp push` transpiles it to Google Apps Script. You
will likely need to allow permission for the spreadsheet and Gmail.

Then, from the spreadsheet, go to Tools -> Script Editor. Click the "Select
function" dropdown and select "createNeoNatalSGDraftPleaEmail". Click the
play button to the left of the function dropdown to run it.

Check your email drafts. If you had it up and don't see anything, click "Drafts"
to refresh the view. You should see a new draft generated by the script.

## Development

### Setup

Install clasp, a cli for managing Apps Script projects locally.

```
npm install @google/clasp -g
```

### Actions

Login to your Google account to create a credentials file:
```
clasp login
```

Update the remote project:
```
clasp push
```

Watch the logs:
```
clasp logs --simplified --watch
```

### Links

#### Apps Script

[Spreadsheet Service][spreadsheet-service]

[GmailApp class][gmail-app]

[Templated HTML with HtmlService][html-service]

[class HtmlOutput][html-output]

[spreadsheet-service]: https://developers.google.com/apps-script/reference/spreadsheet
[gmail-app]: https://developers.google.com/apps-script/reference/gmail/gmail-app
[html-service]: https://developers.google.com/apps-script/guides/html/templates
[html-output]: https://developers.google.com/apps-script/reference/html/html-output

#### Clasp 

[Clasp guide][clasp-guide]

[Clasp docs][clasp-docs]

[Clasp TypeScript guide][clasp-ts]

[clasp-guide]: https://developers.google.com/apps-script/guides/clasp
[clasp-docs]: https://codelabs.developers.google.com/codelabs/clasp/#0
[clasp-ts]: https://github.com/google/clasp/blob/master/docs/typescript.md
